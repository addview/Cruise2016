/**
 * Copyright 2015 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.core.min","./kendo.userevents.min"],e)}(function(){return function(e,t){function n(e,t){if(!e.is(":visible"))return!1;var n=a.getOffset(e),i=t.left+t.width,r=t.top+t.height;return n.right=n.left+e.outerWidth(),n.bottom=n.top+e.outerHeight(),!(n.left>i||t.left>n.right||n.top>r||t.top>n.bottom)}var i,a=window.kendo,r=a.ui.Widget,o=e.proxy,s=Math.abs,l="aria-selected",u="k-state-selected",c="k-state-selecting",d="k-selectable",p="change",h=".kendoSelectable",f="k-state-unselecting",m="input,a,textarea,.k-multiselect-wrap,select,button,a.k-button>.k-icon,button.k-button>.k-icon,span.k-icon.k-i-expand,span.k-icon.k-i-collapse",g=a.support.browser.msie,v=!1;!function(e){!function(){e('<div class="parent"><span /></div>').on("click",">*",function(){v=!0}).find("span").click().end().off()}()}(e),i=r.extend({init:function(t,n){var i,s=this;r.fn.init.call(s,t,n),s._marquee=e("<div class='k-marquee'><div class='k-marquee-color'></div></div>"),s._lastActive=null,s.element.addClass(d),s.relatedTarget=s.options.relatedTarget,i=s.options.multiple,this.options.aria&&i&&s.element.attr("aria-multiselectable",!0),s.userEvents=new a.UserEvents(s.element,{global:!0,allowSelection:!0,filter:(v?"":"."+d+" ")+s.options.filter,tap:o(s._tap,s)}),i&&s.userEvents.bind("start",o(s._start,s)).bind("move",o(s._move,s)).bind("end",o(s._end,s)).bind("select",o(s._select,s))},events:[p],options:{name:"Selectable",filter:">*",multiple:!1,relatedTarget:e.noop},_isElement:function(e){var t,n=this.element,i=n.length,a=!1;for(e=e[0],t=0;i>t;t++)if(n[t]===e){a=!0;break}return a},_tap:function(t){var n,i=e(t.target),a=this,r=t.event.ctrlKey||t.event.metaKey,o=a.options.multiple,s=o&&t.event.shiftKey,l=t.event.which,c=t.event.button;!a._isElement(i.closest("."+d))||l&&3==l||c&&2==c||this._allowSelection(t.event.target)&&(n=i.hasClass(u),o&&r||a.clear(),i=i.add(a.relatedTarget(i)),s?a.selectRange(a._firstSelectee(),i):(n&&r?(a._unselect(i),a._notify(p)):a.value(i),a._lastActive=a._downTarget=i))},_start:function(n){var i,a=this,r=e(n.target),o=r.hasClass(u),s=n.event.ctrlKey||n.event.metaKey;if(this._allowSelection(n.event.target)){if(a._downTarget=r,!a._isElement(r.closest("."+d)))return a.userEvents.cancel(),t;a.options.useAllItems?a._items=a.element.find(a.options.filter):(i=r.closest(a.element),a._items=i.find(a.options.filter)),n.sender.capture(),a._marquee.appendTo(document.body).css({left:n.x.client+1,top:n.y.client+1,width:0,height:0}),s||a.clear(),r=r.add(a.relatedTarget(r)),o&&(a._selectElement(r,!0),s&&r.addClass(f))}},_move:function(e){var t=this,n={left:e.x.startLocation>e.x.location?e.x.location:e.x.startLocation,top:e.y.startLocation>e.y.location?e.y.location:e.y.startLocation,width:s(e.x.initialDelta),height:s(e.y.initialDelta)};t._marquee.css(n),t._invalidateSelectables(n,e.event.ctrlKey||e.event.metaKey),e.preventDefault()},_end:function(){var e,t=this;t._marquee.remove(),t._unselect(t.element.find(t.options.filter+"."+f)).removeClass(f),e=t.element.find(t.options.filter+"."+c),e=e.add(t.relatedTarget(e)),t.value(e),t._lastActive=t._downTarget,t._items=null},_invalidateSelectables:function(e,t){var i,a,r,o,s=this._downTarget[0],l=this._items;for(i=0,a=l.length;a>i;i++)o=l.eq(i),r=o.add(this.relatedTarget(o)),n(o,e)?o.hasClass(u)?t&&s!==o[0]&&r.removeClass(u).addClass(f):o.hasClass(c)||o.hasClass(f)||r.addClass(c):o.hasClass(c)?r.removeClass(c):t&&o.hasClass(f)&&r.removeClass(f).addClass(u)},value:function(e){var n=this,i=o(n._selectElement,n);return e?(e.each(function(){i(this)}),n._notify(p),t):n.element.find(n.options.filter+"."+u)},_firstSelectee:function(){var e,t=this;return null!==t._lastActive?t._lastActive:(e=t.value(),e.length>0?e[0]:t.element.find(t.options.filter)[0])},_selectElement:function(t,n){var i=e(t),a=!n&&this._notify("select",{element:t});i.removeClass(c),a||(i.addClass(u),this.options.aria&&i.attr(l,!0))},_notify:function(e,t){return t=t||{},this.trigger(e,t)},_unselect:function(e){return e.removeClass(u),this.options.aria&&e.attr(l,!1),e},_select:function(t){this._allowSelection(t.event.target)&&(!g||g&&!e(a._activeElement()).is(m))&&t.preventDefault()},_allowSelection:function(t){return e(t).is(m)?(this.userEvents.cancel(),this._downTarget=null,!1):!0},resetTouchEvents:function(){this.userEvents.cancel()},clear:function(){var e=this.element.find(this.options.filter+"."+u);this._unselect(e)},selectRange:function(t,n){var i,a,r,o=this;for(o.clear(),o.element.length>1&&(r=o.options.continuousItems()),r&&r.length||(r=o.element.find(o.options.filter)),t=e.inArray(e(t)[0],r),n=e.inArray(e(n)[0],r),t>n&&(a=t,t=n,n=a),o.options.useAllItems||(n+=o.element.length-1),i=t;n>=i;i++)o._selectElement(r[i]);o._notify(p)},destroy:function(){var e=this;r.fn.destroy.call(e),e.element.off(h),e.userEvents.destroy(),e._marquee=e._lastActive=e.element=e.userEvents=null}}),i.parseOptions=function(e){var t="string"==typeof e&&e.toLowerCase();return{multiple:t&&t.indexOf("multiple")>-1,cell:t&&t.indexOf("cell")>-1}},a.ui.plugin(i)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});