/**
 * Copyright 2015 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.list.min","./kendo.mobile.scroller.min"],e)}(function(){return function(e,t){var n=window.kendo,i=n.ui,a=i.List,o=i.Select,s=n.caret,r=n.support,l=r.placeholder,c=n._activeElement,u=n.keys,d=".kendoComboBox",f="click"+d,h="mousedown"+d,p="disabled",g="readonly",v="change",m="k-state-default",_="k-state-focused",b="k-state-disabled",k="aria-disabled",w="aria-readonly",y="filter",C="accept",F="rebind",x="mouseenter"+d+" mouseleave"+d,S=e.proxy,T=o.extend({init:function(t,i){var a,s,r=this;r.ns=d,i=e.isArray(i)?{dataSource:i}:i,o.fn.init.call(r,t,i),i=r.options,t=r.element.on("focus"+d,S(r._focusHandler,r)),i.placeholder=i.placeholder||t.attr("placeholder"),r._reset(),r._wrapper(),r._input(),r._tabindex(r.input),r._popup(),r._dataSource(),r._ignoreCase(),r._enable(),r._oldIndex=r.selectedIndex=-1,r._aria(),r._initialIndex=i.index,r._initList(),r._cascade(),i.autoBind?r._filterSource():(a=i.text,!a&&r._isSelect&&(a=t.children(":selected").text()),a&&(r.input.val(a),r._prev=a)),a||r._placeholder(),s=e(r.element).parents("fieldset").is(":disabled"),s&&r.enable(!1),n.notify(r)},options:{name:"ComboBox",enabled:!0,index:-1,text:null,value:null,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,filter:"none",placeholder:"",suggest:!1,cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{},template:null,groupTemplate:"#:data#",fixedGroupTemplate:"#:data#"},events:["open","close",v,"select","filtering","dataBinding","dataBound","cascade"],setOptions:function(e){o.fn.setOptions.call(this,e),this.listView.setOptions(e),this._accessors(),this._aria()},destroy:function(){var e=this;e.input.off(d),e.element.off(d),e._inputWrapper.off(d),o.fn.destroy.call(e)},_focusHandler:function(){this.input.focus()},_arrowClick:function(){this._toggle()},_inputFocus:function(){this._inputWrapper.addClass(_),this._placeholder(!1)},_inputFocusout:function(){var e=this;e._inputWrapper.removeClass(_),clearTimeout(e._typingTimeout),e._typingTimeout=null,e.options.text!==e.input.val()&&e.text(e.text()),e._placeholder(),e._blur(),e.element.blur()},_editable:function(e){var t=this,n=e.disable,i=e.readonly,a=t._inputWrapper.off(d),o=t.element.add(t.input.off(d)),s=t._arrow.parent().off(f+" "+h);i||n?(a.addClass(n?b:m).removeClass(n?m:b),o.attr(p,n).attr(g,i).attr(k,n).attr(w,i)):(a.addClass(m).removeClass(b).on(x,t._toggleHover),o.removeAttr(p).removeAttr(g).attr(k,!1).attr(w,!1),s.on(f,S(t._arrowClick,t)).on(h,function(e){e.preventDefault()}),t.input.on("keydown"+d,S(t._keydown,t)).on("focus"+d,S(t._inputFocus,t)).on("focusout"+d,S(t._inputFocusout,t)))},open:function(){var e=this,t=e._state;e.popup.visible()||(!e.listView.isBound()&&t!==y||t===C?(e._open=!0,e._state=F,e.listView.filter(!1),e._filterSource()):(e.popup.open(),e._focusItem()))},_listBound:function(){var e,n,i,a,o=this,s=o.options,r=o._initialIndex,l=o._state===y,u=o.input[0]===c(),d=o.listView,f=d.focus(),h=this.dataSource.flatView(),p=this.dataSource.page(),g=h.length;o._angularItems("compile"),o._presetValue=!1,s.virtual||o._calculateGroupPadding(o._height(g)),o.popup.position(),o._isSelect&&(n=o.element[0].children[0],o._state===F&&(o._state=""),i=!0,a=o._customOption,o._customOption=t,o._options(h,"",o.value()),a&&a[0].selected?o._custom(a.val(),i):n||o._custom("",i)),o._makeUnselectable(),l||o._fetch?l&&f&&f.removeClass("k-state-selected"):(d.value().length||(null!==r&&r>-1?(o.select(r),f=d.focus()):o._accessor()&&d.value(o._accessor())),o._initialIndex=null,e=o.listView.selectedDataItems()[0],e&&o.text()&&o.text()!==o._text(e)&&o._selectValue(e)),!g||p!==t&&1!==p||(s.highlightFirst?f||d.focusIndex()||d.focus(0):d.focus(-1),s.suggest&&u&&o.input.val()&&o.suggest(h[0])),o._open&&(o._open=!1,o._typingTimeout&&!u?o.popup.close():o.toggle(!!g),o._typingTimeout=null),o._touchScroller&&o._touchScroller.reset(),o._hideBusy(),o.trigger("dataBound")},_listChange:function(){this._selectValue(this.listView.selectedDataItems()[0]),this._presetValue&&(this._oldIndex=this.selectedIndex)},_get:function(e){var t,n,i;if("function"==typeof e){for(t=this.dataSource.flatView(),i=0;t.length>i;i++)if(e(t[i])){e=i,n=!0;break}n||(e=-1)}return e},_select:function(e,t){e=this._get(e),-1===e&&(this.input[0].value="",this._accessor("")),this.listView.select(e),t||this._state!==y||(this.listView.filter(!1),this._state=C)},_selectValue:function(e){var n=this.listView.select(),i="",a="";n=n[n.length-1],n===t&&(n=-1),this.selectedIndex=n,-1===n?(i=a=this.input[0].value,this.listView.focus(-1)):(e&&(i=this._dataValue(e),a=this._text(e)),null===i&&(i="")),this._prev=this.input[0].value=a,this._accessor(i!==t?i:a,n),this._placeholder(),this._triggerCascade()},refresh:function(){this.listView.refresh()},suggest:function(e){var n,i=this,o=i.input[0],r=i.text(),l=s(o)[0],d=i._last;return d==u.BACKSPACE||d==u.DELETE?(i._last=t,t):(e=e||"","string"!=typeof e&&(e[0]&&(e=i.dataSource.view()[a.inArray(e[0],i.ul[0])]),e=e?i._text(e):""),0>=l&&(l=r.toLowerCase().indexOf(e.toLowerCase())+1),e?(e=""+e,n=e.toLowerCase().indexOf(r.toLowerCase()),n>-1&&(r+=e.substring(n+r.length))):r=r.substring(0,l),r.length===l&&e||(o.value=r,o===c()&&s(o,l,r.length)),t)},text:function(e){var n,i,a,o,s,r;if(e=null===e?"":e,n=this,i=n.input[0],a=n.options.ignoreCase,o=e,e===t)return i.value;if(s=n.dataItem(),n.options.autoBind!==!1||n.listView.isBound()){if(s&&n._text(s)===e&&(r=n._value(s),null===r?r="":r+="",r===n._old))return n._triggerCascade(),t;a&&(o=o.toLowerCase()),n._select(function(e){return e=n._text(e),a&&(e=(e+"").toLowerCase()),e===o}),0>n.selectedIndex&&(n._accessor(e),i.value=e,n._triggerCascade()),n._prev=i.value}},toggle:function(e){this._toggle(e,!0)},value:function(e){var n=this,i=n.options;return e===t?(e=n._accessor()||n.listView.value()[0],e===t||null===e?"":e):((e!==i.value||n.input.val()!==i.text)&&(n._accessor(e),n.listView.value(e).done(function(){n._selectValue(n.listView.selectedDataItems()[0]),-1===n.selectedIndex&&(n._accessor(e),n.input.val(e),n._placeholder(!0)),n._old=n._accessor(),n._oldIndex=n.selectedIndex,n._prev=n.input.val(),n._state===y&&(n._state=C)}),n._fetchData()),t)},_click:function(e){var n=e.item;return this.trigger("select",{item:n})?(this.close(),t):(this._userTriggered=!0,this._select(n),this._blur(),t)},_filter:function(e){var n,i=this,a=i.options,o=i.dataSource,s=a.ignoreCase,r=function(n){var a=i._text(n);return a!==t?(a+="",""!==a&&""===e?!1:(s&&(a=a.toLowerCase()),0===a.indexOf(e))):t};return s&&(e=e.toLowerCase()),i.ul[0].firstChild?(this.listView.focus(this._get(r)),n=this.listView.focus(),n&&(a.suggest&&i.suggest(n),this.open()),this.options.highlightFirst&&!e&&this.listView.first(),t):(o.one(v,function(){o.view()[0]&&i.search(e)}).fetch(),t)},_input:function(){var t,n=this,i=n.element.removeClass("k-input")[0],a=i.accessKey,o=n.wrapper,s="input.k-input",r=i.name||"";r&&(r='name="'+r+'_input" '),t=o.find(s),t[0]||(o.append('<span tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default"><input '+r+'class="k-input" type="text" autocomplete="off"/><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(n.element),t=o.find(s)),t[0].style.cssText=i.style.cssText,t[0].title=i.title,i.maxLength>-1&&(t[0].maxLength=i.maxLength),t.addClass(i.className).val(this.options.text||i.value).css({width:"100%",height:i.style.height}).attr({role:"combobox","aria-expanded":!1}).show(),l&&t.attr("placeholder",n.options.placeholder),a&&(i.accessKey="",t[0].accessKey=a),n._focused=n.input=t,n._inputWrapper=e(o[0].firstChild),n._arrow=o.find(".k-icon").attr({role:"button",tabIndex:-1}),i.id&&n._arrow.attr("aria-controls",n.ul[0].id)},_keydown:function(e){var t=this,n=e.keyCode;t._last=n,clearTimeout(t._typingTimeout),t._typingTimeout=null,n==u.TAB||t._move(e)||t._search()},_placeholder:function(e){if(!l){var n,i=this,a=i.input,o=i.options.placeholder;if(o){if(n=i.value(),e===t&&(e=!n),a.toggleClass("k-readonly",e),!e){if(n)return;o=""}a.val(o),o||a[0]!==c()||s(a[0],0,0)}}},_search:function(){var e=this;e._typingTimeout=setTimeout(function(){var t=e.text();e._prev!==t&&(e._prev=t,e.search(t)),e._typingTimeout=null},e.options.delay)},_wrapper:function(){var e=this,t=e.element,n=t.parent();n.is("span.k-widget")||(n=t.hide().wrap("<span />").parent(),n[0].style.cssText=t[0].style.cssText),e.wrapper=n.addClass("k-widget k-combobox k-header").addClass(t[0].className).css("display","")},_clearSelection:function(e,t){var n=this,i=e.value(),a=i&&-1===e.selectedIndex;(t||!i||a)&&(n.options.value="",n.value(""))},_preselect:function(e,t){this.input.val(t),this._accessor(e),this._old=this._accessor(),this._oldIndex=this.selectedIndex,this.listView.setValue(e),this._placeholder(),this._initialIndex=null,this._presetValue=!0}});i.plugin(T)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});