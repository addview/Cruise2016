/**
 * Copyright 2015 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.datepicker.min","./kendo.timepicker.min"],e)}(function(){return function(e,t){function n(e){var t=new Date(2100,0,1);return t.setMinutes(-e),t}function i(e){e.preventDefault()}function r(t){var n,i=a.getCulture(t.culture).calendars.standard.patterns,r=!t.parseFormats.length;t.format=u(t.format||i.g),t.timeFormat=n=u(t.timeFormat||i.t),a.DateView.normalize(t),r&&t.parseFormats.push("yyyy-MM-ddTHH:mm:ss"),-1===e.inArray(n,t.parseFormats)&&t.parseFormats.splice(1,0,n)}var a=window.kendo,o=a.TimeView,s=a.parseDate,l=a._activeElement,u=a._extractFormat,c=a.calendar,d=c.isInRange,f=c.restrictValue,h=c.isEqualDatePart,p=o.getMilliseconds,g=a.ui,m=g.Widget,v="open",_="close",y="change",b=".kendoDateTimePicker",w="click"+b,k="disabled",C="readonly",x="k-state-default",S="k-state-focused",F="k-state-hover",T="k-state-disabled",M="mouseenter"+b+" mouseleave"+b,D="mousedown"+b,O="month",A="<span/>",I="aria-activedescendant",V="aria-expanded",E="aria-hidden",P="aria-owns",z="aria-disabled",N="aria-readonly",H=Date,B=new H(1800,0,1),R=new H(2099,11,31),$={view:"date"},L={view:"time"},j=e.extend,q=m.extend({init:function(t,n){var i,o=this;m.fn.init.call(o,t,n),t=o.element,n=o.options,n.min=s(t.attr("min"))||s(n.min),n.max=s(t.attr("max"))||s(n.max),r(n),o._initialOptions=j({},n),o._wrapper(),o._views(),o._icons(),o._reset(),o._template();try{t[0].setAttribute("type","text")}catch(l){t[0].type="text"}t.addClass("k-input").attr({role:"combobox","aria-expanded":!1}),o._midnight=o._calculateMidnight(n.min,n.max),i=t.is("[disabled]")||e(o.element).parents("fieldset").is(":disabled"),i?o.enable(!1):o.readonly(t.is("[readonly]")),o._old=o._update(n.value||o.element.val()),o._oldText=t.val(),a.notify(o)},options:{name:"DateTimePicker",value:null,format:"",timeFormat:"",culture:"",parseFormats:[],dates:[],min:new H(B),max:new H(R),interval:30,height:200,footer:"",start:O,depth:O,animation:{},month:{},ARIATemplate:'Current focused date is #=kendo.toString(data.current, "d")#'},events:[v,_,y],setOptions:function(e){var t,n,i,o=this,l=o._value;m.fn.setOptions.call(o,e),e=o.options,e.min=t=s(e.min),e.max=n=s(e.max),r(e),o._midnight=o._calculateMidnight(e.min,e.max),i=e.value||o._value||o.dateView._current,t&&!h(t,i)&&(t=new H(B)),n&&!h(n,i)&&(n=new H(R)),o.dateView.setOptions(e),o.timeView.setOptions(j({},e,{format:e.timeFormat,min:t,max:n})),l&&(o.element.val(a.toString(l,e.format,e.culture)),o._updateARIA(l))},_editable:function(t){var n=this,r=n.element.off(b),o=n._dateIcon.off(b),s=n._timeIcon.off(b),u=n._inputWrapper.off(b),c=t.readonly,d=t.disable;c||d?(u.addClass(d?T:x).removeClass(d?x:T),r.attr(k,d).attr(C,c).attr(z,d).attr(N,c)):(u.addClass(x).removeClass(T).on(M,n._toggleHover),r.removeAttr(k).removeAttr(C).attr(z,!1).attr(N,!1).on("keydown"+b,e.proxy(n._keydown,n)).on("focus"+b,function(){n._inputWrapper.addClass(S)}).on("focusout"+b,function(){n._inputWrapper.removeClass(S),r.val()!==n._oldText&&n._change(r.val()),n.close("date"),n.close("time")}),o.on(D,i).on(w,function(){n.toggle("date"),a.support.touch||r[0]===l()||r.focus()}),s.on(D,i).on(w,function(){n.toggle("time"),a.support.touch||r[0]===l()||r.focus()}))},readonly:function(e){this._editable({readonly:e===t?!0:e,disable:!1})},enable:function(e){this._editable({readonly:!1,disable:!(e=e===t?!0:e)})},destroy:function(){var e=this;m.fn.destroy.call(e),e.dateView.destroy(),e.timeView.destroy(),e.element.off(b),e._dateIcon.off(b),e._timeIcon.off(b),e._inputWrapper.off(b),e._form&&e._form.off("reset",e._resetHandler)},close:function(e){"time"!==e&&(e="date"),this[e+"View"].close()},open:function(e){"time"!==e&&(e="date"),this[e+"View"].open()},min:function(e){return this._option("min",e)},max:function(e){return this._option("max",e)},toggle:function(e){var t="timeView";"time"!==e?e="date":t="dateView",this[e+"View"].toggle(),this[t].close()},value:function(e){var n=this;return e===t?n._value:(n._old=n._update(e),null===n._old&&n.element.val(""),n._oldText=n.element.val(),t)},_change:function(e){var t=this;e=t._update(e),+t._old!=+e&&(t._old=e,t._oldText=t.element.val(),t.trigger(y),t._typing||t.element.trigger(y))},_option:function(e,i){var r,a,o=this,l=o.options,u=o.timeView,c=u.options,d=o._value||o._old;if(i===t)return l[e];if(i=s(i,l.parseFormats,l.culture)){if(l.min.getTime()===l.max.getTime()&&(c.dates=[]),l[e]=new H(i.getTime()),o.dateView[e](i),o._midnight=o._calculateMidnight(l.min,l.max),d&&(r=h(l.min,d),a=h(l.max,d)),r||a){if(c[e]=i,r&&!a&&(c.max=n(l.interval)),a){if(o._midnight)return u.dataBind([R]),t;r||(c.min=B)}}else c.max=R,c.min=B;u.bind()}},_toggleHover:function(t){e(t.currentTarget).toggleClass(F,"mouseenter"===t.type)},_update:function(t){var i,r,o,l,u,c=this,p=c.options,g=p.min,m=p.max,v=p.dates,_=c.timeView,y=c._value,b=s(t,p.parseFormats,p.culture),w=null===b&&null===y||b instanceof Date&&y instanceof Date;return+b===+y&&w?(u=a.toString(b,p.format,p.culture),u!==t&&c.element.val(null===b?t:u),b):(null!==b&&h(b,g)?b=f(b,g,m):d(b,g,m)||(b=null),c._value=b,_.value(b),c.dateView.value(b),b&&(o=c._old,r=_.options,v[0]&&(v=e.grep(v,function(e){return h(b,e)}),v[0]&&(_.dataBind(v),l=!0)),l||(h(b,g)&&(r.min=g,r.max=n(p.interval),i=!0),h(b,m)&&(c._midnight?(_.dataBind([R]),l=!0):(r.max=m,i||(r.min=B),i=!0))),!l&&(!o&&i||o&&!h(o,b))&&(i||(r.max=R,r.min=B),_.bind())),c.element.val(b?a.toString(b,p.format,p.culture):t),c._updateARIA(b),b)},_keydown:function(e){var t=this,n=t.dateView,i=t.timeView,r=t.element.val(),o=n.popup.visible();e.altKey&&e.keyCode===a.keys.DOWN?t.toggle(o?"time":"date"):o?(n.move(e),t._updateARIA(n._current)):i.popup.visible()?i.move(e):e.keyCode===a.keys.ENTER&&r!==t._oldText?t._change(r):t._typing=!0},_views:function(){var e,t,n,i,r,l,u=this,c=u.element,f=u.options,h=c.attr("id");u.dateView=e=new a.DateView(j({},f,{id:h,anchor:u.wrapper,change:function(){var t,n=e.calendar.value(),i=+n,r=+f.min,a=+f.max;(i===r||i===a)&&(t=new H(+u._value),t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),d(t,r,a)&&(n=t)),u._change(n),u.close("date")},close:function(e){u.trigger(_,$)?e.preventDefault():(c.attr(V,!1),n.attr(E,!0),t.popup.visible()||c.removeAttr(P))},open:function(t){u.trigger(v,$)?t.preventDefault():(c.val()!==u._oldText&&(l=s(c.val(),f.parseFormats,f.culture),u.dateView[l?"current":"value"](l)),n.attr(E,!1),c.attr(V,!0).attr(P,e._dateViewID),u._updateARIA(l))}})),n=e.div,r=f.min.getTime(),u.timeView=t=new o({id:h,value:f.value,anchor:u.wrapper,animation:f.animation,format:f.timeFormat,culture:f.culture,height:f.height,interval:f.interval,min:new H(B),max:new H(R),dates:r===f.max.getTime()?[new Date(r)]:[],parseFormats:f.parseFormats,change:function(n,i){n=t._parse(n),f.min>n?(n=new H(+f.min),t.options.min=n):n>f.max&&(n=new H(+f.max),t.options.max=n),i?(u._timeSelected=!0,u._change(n)):(c.val(a.toString(n,f.format,f.culture)),e.value(n),u._updateARIA(n))},close:function(t){u.trigger(_,L)?t.preventDefault():(i.attr(E,!0),c.attr(V,!1),e.popup.visible()||c.removeAttr(P))},open:function(e){t._adjustListWidth(),u.trigger(v,L)?e.preventDefault():(c.val()!==u._oldText&&(l=s(c.val(),f.parseFormats,f.culture),u.timeView.value(l)),i.attr(E,!1),c.attr(V,!0).attr(P,t._timeViewID),t.options.active(t.current()))},active:function(e){c.removeAttr(I),e&&c.attr(I,t._optionID)}}),i=t.ul},_icons:function(){var t,n=this,i=n.element;t=i.next("span.k-select"),t[0]||(t=e('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(i)),t=t.children(),n._dateIcon=t.eq(0).attr({role:"button","aria-controls":n.dateView._dateViewID}),n._timeIcon=t.eq(1).attr({role:"button","aria-controls":n.timeView._timeViewID})},_wrapper:function(){var t,n=this,i=n.element;t=i.parents(".k-datetimepicker"),t[0]||(t=i.wrap(A).parent().addClass("k-picker-wrap k-state-default"),t=t.wrap(A).parent()),t[0].style.cssText=i[0].style.cssText,i.css({width:"100%",height:i[0].style.height}),n.wrapper=t.addClass("k-widget k-datetimepicker k-header").addClass(i[0].className),n._inputWrapper=e(t[0].firstChild)},_reset:function(){var t=this,n=t.element,i=n.attr("form"),r=i?e("#"+i):n.closest("form");r[0]&&(t._resetHandler=function(){t.value(n[0].defaultValue),t.max(t._initialOptions.max),t.min(t._initialOptions.min)},t._form=r.on("reset",t._resetHandler))},_template:function(){this._ariaTemplate=a.template(this.options.ARIATemplate)},_calculateMidnight:function(e,t){return p(e)+p(t)===0},_updateARIA:function(e){var t,n=this,i=n.dateView.calendar;n.element.removeAttr(I),i&&(t=i._cell,t.attr("aria-label",n._ariaTemplate({current:e||i.current()})),n.element.attr(I,t.attr("id")))}});g.plugin(q)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});