/**
 * Copyright 2015 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.data.min","./kendo.popup.min"],e)}(function(){return function(e,t){function n(e,t){var n,i,r,a=t.length,o=[];for(i=0;e.length>i;i++)for(n=e[i],r=0;a>r;r++)n===t[r]&&o.push({index:i,item:n});return o}function i(t,n){var r,a=!1;return t.filters&&(r=e.grep(t.filters,function(e){return a=i(e,n),e.filters?e.filters.length:e.field!=n}),a||t.filters.length===r.length||(a=!0),t.filters=r),a}var r,a,o=window.kendo,s=o.ui,l=s.Widget,u=o.keys,c=o.support,d=o.htmlEncode,f=o._activeElement,p=o.data.ObservableArray,h="id",g="change",m="k-state-focused",v="k-state-hover",_="k-loading",y="open",b="close",w="select",k="selected",x="requestStart",C="requestEnd",S="width",T=e.extend,F=e.proxy,M=e.isArray,D=c.browser,I=D.msie&&9>D.version,O=/"/g,V={ComboBox:"DropDownList",DropDownList:"ComboBox"},A=o.ui.DataBoundWidget.extend({init:function(t,n){var i,r=this,a=r.ns;l.fn.init.call(r,t,n),t=r.element,n=r.options,r._isSelect=t.is(w),r._isSelect&&r.element[0].length&&(n.dataSource||(n.dataTextField=n.dataTextField||"text",n.dataValueField=n.dataValueField||"value")),r.ul=e('<ul unselectable="on" class="k-list k-reset"/>').attr({tabIndex:-1,"aria-hidden":!0}),r.list=e("<div class='k-list-container'/>").append(r.ul).on("mousedown"+a,F(r._listMousedown,r)),i=t.attr(h),i&&(r.list.attr(h,i+"-list"),r.ul.attr(h,i+"_listbox")),r._header(),r._accessors(),r._initValue()},options:{valuePrimitive:!1,headerTemplate:""},setOptions:function(e){l.fn.setOptions.call(this,e),e&&e.enable!==t&&(e.enabled=e.enable)},focus:function(){this._focused.focus()},readonly:function(e){this._editable({readonly:e===t?!0:e,disable:!1})},enable:function(e){this._editable({readonly:!1,disable:!(e=e===t?!0:e)})},_listOptions:function(e){var t=this.options;return e=e||{},e={height:e.height||t.height,dataValueField:e.dataValueField||t.dataValueField,dataTextField:e.dataTextField||t.dataTextField,groupTemplate:e.groupTemplate||t.groupTemplate,fixedGroupTemplate:e.fixedGroupTemplate||t.fixedGroupTemplate,template:e.template||t.template},e.template||(e.template="#:"+o.expr(e.dataTextField,"data")+"#"),e},_initList:function(){var n=this,i=n.options,r=i.virtual,a=!!r,s=i.value,l=F(n._listBound,n),u={autoBind:!1,selectable:!0,dataSource:n.dataSource,click:F(n._click,n),change:F(n._listChange,n),activate:F(n._activateItem,n),deactivate:F(n._deactivateItem,n),dataBinding:function(){n.trigger("dataBinding"),n._angularItems("cleanup")},dataBound:l,listBound:l,selectedItemChange:F(n._listChange,n)};u=e.extend(n._listOptions(),u,"object"==typeof r?r:{}),n.listView=a?new o.ui.VirtualList(n.ul,u):new o.ui.StaticList(n.ul,u),s!==t&&n.listView.value(s).done(function(){var e=i.text;!n.listView.filter()&&n.input&&(-1===n.selectedIndex?((e===t||null===e)&&(e=s),n._accessor(s),n.input.val(e)):-1===n._oldIndex&&(n._oldIndex=n.selectedIndex))})},_listMousedown:function(e){this.filterInput&&this.filterInput[0]===e.target||e.preventDefault()},_filterSource:function(e,t){var n=this,r=n.options,a=n.dataSource,o=T({},a.filter()||{}),s=i(o,r.dataTextField);(e||s)&&n.trigger("filtering",{filter:e})||(e&&(o=o.filters||[],o.push(e)),t?a.read(o):a.filter(o))},_header:function(){var t,n=this,i=n.options.headerTemplate;e.isFunction(i)&&(i=i({})),i&&(n.list.prepend(i),t=n.ul.prev(),n.header=t[0]?t:null,n.header&&n.angular("compile",function(){return{elements:n.header}}))},_initValue:function(){var e=this,t=e.options.value;null!==t?e.element.val(t):(t=e._accessor(),e.options.value=t),e._old=t},_ignoreCase:function(){var e,t=this,n=t.dataSource.reader.model;n&&n.fields&&(e=n.fields[t.options.dataTextField],e&&e.type&&"string"!==e.type&&(t.options.ignoreCase=!1))},_focus:function(e){return this.listView.focus(e)},current:function(e){return this._focus(e)},items:function(){return this.ul[0].children},destroy:function(){var e=this,t=e.ns;l.fn.destroy.call(e),e._unbindDataSource(),e.listView.destroy(),e.list.off(t),e.popup.destroy(),e._form&&e._form.off("reset",e._resetHandler)},dataItem:function(n){var i=this;return n===t?i.listView.selectedDataItems()[0]:("number"!=typeof n&&(n=e(i.items()).index(n)),i.dataSource.flatView()[n])},_activateItem:function(){var e=this.listView.focus();e&&this._focused.add(this.filterInput).attr("aria-activedescendant",e.attr("id"))},_deactivateItem:function(){this._focused.add(this.filterInput).removeAttr("aria-activedescendant")},_accessors:function(){var e=this,t=e.element,n=e.options,i=o.getter,r=t.attr(o.attr("text-field")),a=t.attr(o.attr("value-field"));!n.dataTextField&&r&&(n.dataTextField=r),!n.dataValueField&&a&&(n.dataValueField=a),e._text=i(n.dataTextField),e._value=i(n.dataValueField)},_aria:function(e){var n=this,i=n.options,r=n._focused.add(n.filterInput);i.suggest!==t&&r.attr("aria-autocomplete",i.suggest?"both":"list"),e=e?e+" "+n.ul[0].id:n.ul[0].id,r.attr("aria-owns",e),n.ul.attr("aria-live",i.filter&&"none"!==i.filter?"polite":"off")},_blur:function(){var e=this;e._change(),e.close()},_change:function(){var e,n=this,i=n.selectedIndex,r=n.options.value,a=n.value();n._isSelect&&!n.listView.isBound()&&r&&(a=r),a!==n._old?e=!0:i!==t&&i!==n._oldIndex&&(e=!0),e&&(n._old=a,n._oldIndex=i,n._typing||n.element.trigger(g),n.trigger(g)),n.typing=!1},_data:function(){return this.dataSource.view()},_enable:function(){var e=this,n=e.options,i=e.element.is("[disabled]");n.enable!==t&&(n.enabled=n.enable),!n.enabled||i?e.enable(!1):e.readonly(e.element.is("[readonly]"))},_dataValue:function(e){var n=this._value(e);return n===t&&(n=this._text(e)),n},_offsetHeight:function(){var t=0,n=this.listView.content.prevAll(":visible");return n.each(function(){var n=e(this);t+=n.hasClass("k-list-filter")?n.children().outerHeight():n.outerHeight()}),t},_height:function(e){var t,n,i=this,r=i.list,a=i.options.height,o=i.popup.visible();return e&&(n=r.add(r.parent(".k-animation-container")).show(),a=i.listView.content[0].scrollHeight>a?a:"auto",n.height(a),"auto"!==a&&(t=i._offsetHeight(),t&&(a-=t)),i.listView.content.height(a),o||n.hide()),a},_adjustListWidth:function(){var e,t,n=this.list,i=n[0].style.width,r=this.wrapper;if(n.data(S)||!i)return e=window.getComputedStyle?window.getComputedStyle(r[0],null):0,t=e?parseFloat(e.width):r.outerWidth(),e&&D.msie&&(t+=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)+parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth)),i="border-box"!==n.css("box-sizing")?t-(n.outerWidth()-n.width()):t,n.css({fontFamily:r.css("font-family"),width:i}).data(S,i),!0},_openHandler:function(e){this._adjustListWidth(),this.trigger(y)?e.preventDefault():(this._focused.attr("aria-expanded",!0),this.ul.attr("aria-hidden",!1))},_closeHandler:function(e){this.trigger(b)?e.preventDefault():(this._focused.attr("aria-expanded",!1),this.ul.attr("aria-hidden",!0))},_focusItem:function(){var e=this.listView,n=e.focus(),i=e.select();i=i[i.length-1],i===t&&this.options.highlightFirst&&!n&&(i=0),i!==t?e.focus(i):e.scrollToIndex(0)},_calculateGroupPadding:function(e){var t=this.ul.children(".k-first:first"),n=this.listView.content.prev(".k-group-header"),i=0;n[0]&&"none"!==n[0].style.display&&("auto"!==e&&(i=o.support.scrollbar()),i+=parseFloat(t.css("border-right-width"),10)+parseFloat(t.children(".k-group").css("padding-right"),10),n.css("padding-right",i))},_firstOpen:function(){var e=this._height(this.dataSource.flatView().length);this._calculateGroupPadding(e)},_popup:function(){var e=this;e.popup=new s.Popup(e.list,T({},e.options.popup,{anchor:e.wrapper,open:F(e._openHandler,e),close:F(e._closeHandler,e),animation:e.options.animation,isRtl:c.isRtl(e.wrapper)})),e.options.virtual||e.popup.one(y,F(e._firstOpen,e))},_makeUnselectable:function(){I&&this.list.find("*").not(".k-textbox").attr("unselectable","on")},_toggleHover:function(t){e(t.currentTarget).toggleClass(v,"mouseenter"===t.type)},_toggle:function(e,n){var i=this,r=c.mobileOS&&(c.touch||c.MSPointers||c.pointers);e=e!==t?e:!i.popup.visible(),n||r||i._focused[0]===f()||(i._prevent=!0,i._focused.focus(),i._prevent=!1),i[e?y:b]()},_triggerCascade:function(){var e=this;e._cascadeTriggered&&e._old===e.value()&&e._oldIndex===e.selectedIndex||(e._cascadeTriggered=!0,e.trigger("cascade",{userTriggered:e._userTriggered}))},_unbindDataSource:function(){var e=this;e.dataSource.unbind(x,e._requestStartHandler).unbind(C,e._requestEndHandler).unbind("error",e._errorHandler)}});T(A,{inArray:function(e,t){var n,i,r=t.children;if(!e||e.parentNode!==t)return-1;for(n=0,i=r.length;i>n;n++)if(e===r[n])return n;return-1}}),o.ui.List=A,s.Select=A.extend({init:function(e,t){A.fn.init.call(this,e,t),this._initial=this.element.val()},setDataSource:function(e){var t,n=this;n.options.dataSource=e,n._dataSource(),n.listView.setDataSource(n.dataSource),n.options.autoBind&&n.dataSource.fetch(),t=n._parentWidget(),t&&n._cascadeSelect(t)},close:function(){this.popup.close()},select:function(e){var n=this;return e===t?n.selectedIndex:(n._select(e),n._old=n._accessor(),n._oldIndex=n.selectedIndex,t)},search:function(e){var t,n,i,r,a,o;e="string"==typeof e?e:this.text(),t=this,n=e.length,i=t.options,r=i.ignoreCase,a=i.filter,o=i.dataTextField,clearTimeout(t._typingTimeout),(!n||n>=i.minLength)&&(t._state="filter",t.listView.filter(!0),"none"===a?t._filter(e):(t._open=!0,t._filterSource({value:r?e.toLowerCase():e,field:o,operator:a,ignoreCase:r})))},_accessor:function(e,t){return this[this._isSelect?"_accessorSelect":"_accessorInput"](e,t)},_accessorInput:function(e){var n=this.element[0];return e===t?n.value:(null===e&&(e=""),n.value=e,t)},_accessorSelect:function(e,n){var i,r=this.element[0],a=r.selectedIndex;return e===t?(a>-1&&(i=r.options[a]),i&&(e=i.value),e||""):(a>-1&&r.options[a].removeAttribute(k),n===t&&(n=-1),null!==e&&""!==e&&-1==n?this._custom(e):(e?r.value=e:r.selectedIndex=n,r.selectedIndex>-1&&(i=r.options[r.selectedIndex]),i&&i.setAttribute(k,k)),t)},_custom:function(t){var n=this,i=n.element,r=n._customOption;r||(r=e("<option/>"),n._customOption=r,i.append(r)),r.text(t),r[0].setAttribute(k,k),r[0].selected=!0},_hideBusy:function(){var e=this;clearTimeout(e._busy),e._arrow.removeClass(_),e._focused.attr("aria-busy",!1),e._busy=null},_showBusy:function(){var e=this;e._request=!0,e._busy||(e._busy=setTimeout(function(){e._arrow&&(e._focused.attr("aria-busy",!0),e._arrow.addClass(_))},100))},_requestEnd:function(){this._request=!1,this._hideBusy()},_dataSource:function(){var t,n=this,i=n.element,r=n.options,a=r.dataSource||{};a=e.isArray(a)?{data:a}:a,n._isSelect&&(t=i[0].selectedIndex,t>-1&&(r.index=t),a.select=i,a.fields=[{field:r.dataTextField},{field:r.dataValueField}]),n.dataSource?n._unbindDataSource():(n._requestStartHandler=F(n._showBusy,n),n._requestEndHandler=F(n._requestEnd,n),n._errorHandler=F(n._hideBusy,n)),n.dataSource=o.data.DataSource.create(a).bind(x,n._requestStartHandler).bind(C,n._requestEndHandler).bind("error",n._errorHandler)},_firstItem:function(){this.listView.first()},_lastItem:function(){this.listView.last()},_nextItem:function(){this.listView.next()},_prevItem:function(){this.listView.prev()},_move:function(e){var n,i,r,a,o=this,s=e.keyCode,l=s===u.DOWN;if(s===u.UP||l){if(e.altKey)o.toggle(l);else{if(!o.listView.isBound())return o._fetch||(o.dataSource.one(g,function(){o._fetch=!1,o._move(e)}),o._fetch=!0,o._filterSource()),e.preventDefault(),!0;if(r=o._focus(),o._fetch||r&&!r.hasClass("k-state-selected")||(l?(o._nextItem(),o._focus()||o._lastItem()):(o._prevItem(),o._focus()||o._firstItem())),o.trigger(w,{item:o.listView.focus()}))return o._focus(r),t;o._select(o._focus(),!0),o.popup.visible()||o._blur()}e.preventDefault(),i=!0}else if(s===u.ENTER||s===u.TAB){if(o.popup.visible()&&e.preventDefault(),r=o._focus(),n=o.dataItem(),o.popup.visible()||n&&o.text()===o._text(n)||(r=null),a=o.filterInput&&o.filterInput[0]===f(),r){if(o.trigger(w,{item:r}))return;o._select(r)}else o.input&&(o._accessor(o.input.val()),o.listView.value(o.input.val()));o._focusElement&&o._focusElement(o.wrapper),a&&s===u.TAB?o.wrapper.focusout():o._blur(),o.close(),i=!0}else s===u.ESC&&(o.popup.visible()&&e.preventDefault(),o.close(),i=!0);return i},_fetchData:function(){var e=this,t=!!e.dataSource.view().length;e._request||e.options.cascadeFrom||e.listView.isBound()||e._fetch||t||(e._fetch=!0,e.dataSource.fetch().done(function(){e._fetch=!1}))},_options:function(e,n,i){var r,a,o,s,l=this,u=l.element,c=e.length,f="",p=0;for(n&&(f=n);c>p;p++)r="<option",a=e[p],o=l._text(a),s=l._value(a),s!==t&&(s+="",-1!==s.indexOf('"')&&(s=s.replace(O,"&quot;")),r+=' value="'+s+'"'),r+=">",o!==t&&(r+=d(o)),r+="</option>",f+=r;u.html(f),i!==t&&(u[0].value=i)},_reset:function(){var t=this,n=t.element,i=n.attr("form"),r=i?e("#"+i):n.closest("form");r[0]&&(t._resetHandler=function(){setTimeout(function(){t.value(t._initial)})},t._form=r.on("reset",t._resetHandler))},_parentWidget:function(){var t=this.options.name,n=e("#"+this.options.cascadeFrom),i=n.data("kendo"+t);return i||(i=n.data("kendo"+V[t])),i},_cascade:function(){var e,t=this,n=t.options,i=n.cascadeFrom;if(i){if(e=t._parentWidget(),!e)return;n.autoBind=!1,e.first("cascade",function(n){t._userTriggered=n.userTriggered,t._cascadeSelect(e)}),e.listView.isBound()?t._cascadeSelect(e):e.value()||t.enable(!1)}},_cascadeChange:function(e){var t=this,n=t._accessor();t._userTriggered?t._clearSelection(e,!0):n?(n!==t.listView.value()[0]&&t.value(n),t.dataSource.view()[0]&&-1!==t.selectedIndex||t._clearSelection(e,!0)):t.dataSource.flatView().length&&t.select(t.options.index),t.enable(),t._triggerCascade(),t._userTriggered=!1},_cascadeSelect:function(e){var t,n,r,a=this,o=e.dataItem(),s=o?e._value(o):null,l=a.options.cascadeFromField||e.options.dataValueField;s||0===s?(t=a.dataSource.filter()||{},i(t,l),n=t.filters||[],n.push({field:l,operator:"eq",value:s}),r=function(){a.unbind("dataBound",r),a._cascadeChange(e)},a.first("dataBound",r),a.dataSource.filter(n)):(a.enable(!1),a._clearSelection(e),a._triggerCascade(),a._userTriggered=!1)}}),r=".StaticList",a=o.ui.DataBoundWidget.extend({init:function(t,n){l.fn.init.call(this,t,n),this.element.attr("role","listbox").on("click"+r,"li",F(this._click,this)).on("mouseenter"+r,"li",function(){e(this).addClass(v)}).on("mouseleave"+r,"li",function(){e(this).removeClass(v)}),this.content=this.element.wrap("<div unselectable='on'></div>").parent().css({overflow:"auto",position:"relative"}),this.header=this.content.before('<div class="k-group-header" style="display:none"></div>').prev(),this._bound=!1,this._optionID=o.guid(),this._selectedIndices=[],this._view=[],this._dataItems=[],this._values=[];var i=this.options.value;i&&(this._values=e.isArray(i)?i.slice(0):[i]),this._getter(),this._templates(),this.setDataSource(this.options.dataSource),this._onScroll=F(function(){var e=this;clearTimeout(e._scrollId),e._scrollId=setTimeout(function(){e._renderHeader()},50)},this)},options:{name:"StaticList",dataValueField:null,selectable:!0,template:null,groupTemplate:null,fixedGroupTemplate:null},events:["click","change","activate","deactivate","dataBinding","dataBound","selectedItemChange"],setDataSource:function(t){var n,i=this,r=t||{};r=e.isArray(r)?{data:r}:r,r=o.data.DataSource.create(r),i.dataSource?(i.dataSource.unbind(g,i._refreshHandler),n=i.value(),i.value([]),i._bound=!1,i.value(n)):i._refreshHandler=F(i.refresh,i),i.dataSource=r.bind(g,i._refreshHandler),i._fixedHeader()},setOptions:function(e){l.fn.setOptions.call(this,e),this._getter(),this._templates(),this._render()},destroy:function(){this.element.off(r),this._refreshHandler&&this.dataSource.unbind(g,this._refreshHandler),l.fn.destroy.call(this)},scrollToIndex:function(e){var t=this.element[0].children[e];t&&this.scroll(t)},scroll:function(e){if(e){e[0]&&(e=e[0]);var t=this.content[0],n=e.offsetTop,i=e.offsetHeight,r=t.scrollTop,a=t.clientHeight,o=n+i;r>n?r=n:o>r+a&&(r=o-a),t.scrollTop=r}},selectedDataItems:function(n){var i=this._valueGetter;return n===t?this._dataItems.slice():(this._dataItems=n,this._values=e.map(n,function(e){return i(e)}),t)},next:function(){var e=this.focus();e=e?e.next():0,this.focus(e)},prev:function(){var e=this.focus();e=e?e.prev():this.element[0].children.length-1,this.focus(e)},first:function(){this.focus(this.element[0].children[0])},last:function(){this.focus(this.element[0].children[this.element[0].children.length-1])},focus:function(n){var i,r=this,a=r._optionID;return n===t?r._current:(n=r._get(n),n=n[n.length-1],n=e(this.element[0].children[n]),r._current&&(r._current.removeClass(m).removeAttr("aria-selected").removeAttr(h),r.trigger("deactivate")),i=!!n[0],i&&(n.addClass(m),r.scroll(n),n.attr("id",a)),r._current=i?n:null,r.trigger("activate"),t)},focusIndex:function(){return this.focus()?this.focus().index():t},filter:function(e){return e===t?this._filtered:(this._filtered=e,t)},skipUpdate:function(e){this._skipUpdate=e},select:function(n){var i,r=this,a=r.options.selectable,o="multiple"!==a&&a!==!1,s=r._selectedIndices,l=[],u=[];if(n===t)return s.slice();if(n=r._get(n),1===n.length&&-1===n[0]&&(n=[]),!r._filtered||o||!r._deselectFiltered(n)){if(o&&!r._filtered&&-1!==e.inArray(n[n.length-1],s))return r._dataItems.length&&r._view.length&&(r._dataItems=[r._view[s[0]].item]),t;i=r._deselect(n),u=i.removed,n=i.indices,n.length&&(o&&(n=[n[n.length-1]]),l=r._select(n)),(l.length||u.length)&&(r._valueComparer=null,r.trigger("change",{added:l,removed:u}))}},removeAt:function(e){return this._selectedIndices.splice(e,1),this._values.splice(e,1),{position:e,dataItem:this._dataItems.splice(e,1)[0]}},setValue:function(t){t=e.isArray(t)||t instanceof p?t.slice(0):[t],this._values=t,this._valueComparer=null},value:function(n){var i,r=this,a=r._valueDeferred;return n===t?r._values.slice():(r.setValue(n),a&&"resolved"!==a.state()||(r._valueDeferred=a=e.Deferred()),r.isBound()&&(i=r._valueIndices(r._values),"multiple"===r.options.selectable&&r.select(-1),r.select(i),a.resolve()),r._skipUpdate=!1,a)},_click:function(t){t.isDefaultPrevented()||this.trigger("click",{item:e(t.currentTarget)})},_valueExpr:function(e,n){var i,r,a,o=this,s=0,l=[];if(!o._valueComparer||o._valueType!==e){for(o._valueType=e;n.length>s;s++)i=n[s],i!==t&&""!==i&&null!==i&&("boolean"===e?i=!!i:"number"===e?i=+i:"string"===e&&(i=""+i)),l.push(i);r="for (var idx = 0; idx < "+l.length+"; idx++) { if (current === values[idx]) {   return idx; }} return -1;",a=Function(["current","values"],r),o._valueComparer=function(e){return a(e,l)}}return o._valueComparer},_dataItemPosition:function(e,t){var n=this._valueGetter(e),i=this._valueExpr(typeof n,t);return i(n)},_getter:function(){this._valueGetter=o.getter(this.options.dataValueField)},_deselect:function(t){var n,i,r,a=this,o=a.element[0].children,s=a.options.selectable,l=a._selectedIndices,u=a._dataItems,c=a._values,d=[],f=0,p=0;if(t=t.slice(),s!==!0&&t.length){if("multiple"===s)for(;t.length>f;f++)if(i=t[f],e(o[i]).hasClass("k-state-selected"))for(n=0;l.length>n;n++)if(r=l[n],r===i){e(o[r]).removeClass("k-state-selected"),d.push({position:n+p,dataItem:u.splice(n,1)[0]}),l.splice(n,1),t.splice(f,1),c.splice(n,1),p+=1,f-=1,n-=1;break}}else{for(;l.length>f;f++)e(o[l[f]]).removeClass("k-state-selected"),d.push({position:f,dataItem:u[f]});a._values=[],a._dataItems=[],a._selectedIndices=[]}return{indices:t,removed:d}},_deselectFiltered:function(t){for(var n,i,r,a=this.element[0].children,o=[],s=0;t.length>s;s++)i=t[s],n=this._view[i].item,r=this._dataItemPosition(n,this._values),r>-1&&(o.push(this.removeAt(r)),e(a[i]).removeClass("k-state-selected"));return o.length?(this.trigger("change",{added:[],removed:o}),!0):!1},_select:function(t){var n,i,r=this,a=r.element[0].children,o=r._view,s=[],l=0;for(-1!==t[t.length-1]&&r.focus(t);t.length>l;l++)i=t[l],n=o[i],-1!==i&&n&&(n=n.item,r._selectedIndices.push(i),r._dataItems.push(n),r._values.push(r._valueGetter(n)),e(a[i]).addClass("k-state-selected").attr("aria-selected",!0),s.push({dataItem:n}));return s},_get:function(n){return"number"==typeof n?n=[n]:M(n)||(n=e(n).data("offset-index"),n===t&&(n=-1),n=[n]),n},_template:function(){var e=this,t=e.options,n=t.template;return n?(n=o.template(n),n=function(e){return'<li tabindex="-1" role="option" unselectable="on" class="k-item">'+n(e)+"</li>"}):n=o.template('<li tabindex="-1" role="option" unselectable="on" class="k-item">${'+o.expr(t.dataTextField,"data")+"}</li>",{useWithBlock:!1}),n},_templates:function(){var e,t,n={template:this.options.template,groupTemplate:this.options.groupTemplate,fixedGroupTemplate:this.options.fixedGroupTemplate};for(t in n)e=n[t],e&&"function"!=typeof e&&(n[t]=o.template(e));this.templates=n},_normalizeIndices:function(e){for(var n=[],i=0;e.length>i;i++)e[i]!==t&&n.push(e[i]);return n},_valueIndices:function(e,t){var n,i=this._view,r=0;if(t=t?t.slice():[],!e.length)return[];for(;i.length>r;r++)n=this._dataItemPosition(i[r].item,e),-1!==n&&(t[n]=r);return this._normalizeIndices(t)},_firstVisibleItem:function(){for(var t=this.element[0],n=this.content[0],i=n.scrollTop,r=e(t.children[0]).height(),a=Math.floor(i/r)||0,o=t.children[a]||t.lastChild,s=i>o.offsetTop;o;)if(s){if(o.offsetTop+r>i||!o.nextSibling)break;o=o.nextSibling}else{if(i>=o.offsetTop||!o.previousSibling)break;o=o.previousSibling}return this._view[e(o).data("offset-index")]},_fixedHeader:function(){this.isGrouped()&&this.templates.fixedGroupTemplate?(this.header.show(),this.content.scroll(this._onScroll)):(this.header.hide(),this.content.off("scroll",this._onScroll))},_renderHeader:function(){var e,t=this.templates.fixedGroupTemplate;t&&(e=this._firstVisibleItem(),e&&this.header.html(t(e.group)))},_renderItem:function(e){var t='<li tabindex="-1" role="option" unselectable="on" class="k-item',n=e.item,i=0!==e.index,r=e.selected;return i&&e.newGroup&&(t+=" k-first"),r&&(t+=" k-state-selected"),t+='"'+(r?' aria-selected="true"':"")+' data-offset-index="'+e.index+'">',t+=this.templates.template(n),i&&e.newGroup&&(t+='<div class="k-group">'+this.templates.groupTemplate(e.group)+"</div>"),t+"</li>"},_render:function(){var e,t,n,i,r="",a=0,o=0,s=[],l=this.dataSource.view(),u=this.value(),c=this.isGrouped();if(c)for(a=0;l.length>a;a++)for(t=l[a],n=!0,i=0;t.items.length>i;i++)e={selected:this._selected(t.items[i],u),item:t.items[i],group:t.value,newGroup:n,index:o},s[o]=e,o+=1,r+=this._renderItem(e),n=!1;else for(a=0;l.length>a;a++)e={selected:this._selected(l[a],u),item:l[a],index:a},s[a]=e,r+=this._renderItem(e);this._view=s,this.element[0].innerHTML=r,c&&s.length&&this._renderHeader()},_selected:function(e,t){var n=!this._filtered||"multiple"===this.options.selectable;return n&&-1!==this._dataItemPosition(e,t)},refresh:function(e){var t,i=this,r=e&&e.action;i.trigger("dataBinding"),i._fixedHeader(),i._render(),i._bound=!0,"itemchange"===r?(t=n(i._dataItems,e.items),t.length&&i.trigger("selectedItemChange",{items:t})):i._filtered||i._skipUpdate?(i.focus(0),i._skipUpdate&&(i._skipUpdate=!1,i._selectedIndices=i._valueIndices(i._values,i._selectedIndices))):r&&"add"!==r||i.value(i._values),i._valueDeferred&&i._valueDeferred.resolve(),i.trigger("dataBound")},isBound:function(){return this._bound},isGrouped:function(){return(this.dataSource.group()||[]).length}}),s.plugin(a)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});